function Agent(){this.dna="",this.dnaString="",this.nums,this.theta,this.startBranch,this.angleCounter=0,this.anglePlus,this.angleDivider,this.sizeReduction,this.r,this.rotater,this.circle,this.rectangle,this.lines,this.branch1,this.branch2,this.branch3,this.branch4,this.size1,this.size2,this.endForm,this.opacity=90,this.construct=function(a){for(var b=0;b<a;b++)random(1)<.5?this.dna+="0":this.dna+="1";this.nums=a,this.format()},this.constructDNAexists=function(a,b){this.dna=a,this.nums=b,this.format()},this.mate=function(a){for(var b="",c=0;c<this.dna.length;c+=geneLength)b+=random(1)<.5?this.dna.substring(c,c+geneLength):a.dna.substring(c,c+geneLength);return print(b.length),b},this.mutate=function(a){for(var b=0;b<this.dna.length;b++)random(1)<a&&("0"==this.dna.charAt(b)?this.dna=this.setCharAt(this.dna,b,"1"):this.dna=this.setCharAt(this.dna,b,"0"));this.format()},this.setCharAt=function(a,b,c){return b>a.length-1?a:a.substr(0,b)+c+a.substr(b+1)},this.display=function(a,b){strokeWeight(3),noFill(),rectMode(CENTER),ellipseMode(CENTER);var c=Math.sin(this.angleCounter)/this.angleDivider;this.angleCounter+=this.anglePlus,this.angleCounter>TWO_PI&&(this.angleCounter=0),this.theta-=c,push(),translate(a,b),scale(scaler),rotate(this.rotater),this.rotater+=this.r,this.branch(this.theta,this.startBranch),pop()},this.branch=function(a,b){if(b*=this.sizeReduction,b>25)push(),rotate(a),this.switcher(this.branch1,-b),translate(0,-b),this.branch(a,b),pop(),push(),rotate(-a),this.switcher(this.branch2,-b),translate(0,-b),this.branch(a,b),pop(),push(),rotate(a),this.switcher(this.branch3,b),translate(0,b),this.branch(a,b),pop(),push(),rotate(-a),this.switcher(this.branch4,b),translate(0,b),this.branch(a,b),pop();else switch(this.endForm){case 0:stroke(this.circle),ellipse(0,0,this.size2,this.size2);break;case 1:stroke(this.rectangle),rect(0,0,this.size2,this.size2),stroke(this.circle,100),ellipse(0,0,this.size2,this.size2);break;case 2:stroke(this.rectangle),rect(0,0,this.size2,this.size2);break;case 3:}},this.format=function(){this.dnaString=this.dna,this.theta=this.getAngle(),this.startBranch=this.getStartBranch(),this.anglePlus=this.getAnglePlus(),this.angleDivider=this.getAngleDivider(),this.sizeReduction=this.getSizeReduction(),this.r=this.getRotationSpeed(),this.circle=this.getColorOne(),this.rectangle=this.getColorTwo(),this.lines=this.getColorThree(),this.branch1=this.getBranch1(),this.branch2=this.getBranch2(),this.branch3=this.getBranch3(),this.branch4=this.getBranch4(),this.size1=this.getSize1(),this.size2=this.getSize2(),this.endForm=this.getEndForm(),this.rotater=this.getRotator()},this.switcher=function(a,b){switch(a){case 0:break;case 1:strokeWeight(3),stroke(this.lines),line(0,0,0,b);break;case 2:strokeWeight(3),stroke(this.lines),line(0,0,0,b),strokeWeight(2),stroke(this.circle),ellipse(0,0,this.size1,this.size1);break;case 3:strokeWeight(3),stroke(this.lines),line(0,0,0,b),strokeWeight(2),stroke(this.rectangle),rect(0,0,this.size1,this.size1);break;case 4:strokeWeight(3),stroke(this.lines),line(0,0,0,b),strokeWeight(2),stroke(this.circle),ellipse(0,0,this.size1,this.size1),stroke(this.rectangle),rect(0,0,this.size1,this.size1);break;case 5:strokeWeight(3),stroke(this.lines),line(0,0,0,b),strokeWeight(2),stroke(this.circle),ellipse(0,0,this.size1,this.size1);break;case 6:stroke(this.circle),ellipse(0,0,this.size1,this.size1),stroke(this.rectangle),rect(0,0,this.size1,this.size1);break;case 7:stroke(this.rectangle),rect(0,0,this.size1,this.size1);break;default:stroke(this.circle),ellipse(0,0,this.size1,this.size1)}},this.getAngle=function(){var a=this.dna.substr(0,1*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,TWO_PI)},this.getStartBranch=function(){var a=this.dna.substring(1*geneLength,2*geneLength),b=parseInt(a,2);return b=map(b,0,1023,20,66)},this.getAnglePlus=function(){var a=this.dna.substring(2*geneLength,3*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,.5)},this.getAngleDivider=function(){var a=this.dna.substring(3*geneLength,4*geneLength),b=parseInt(a,2);return b=map(b,0,1023,.1,50)},this.getSizeReduction=function(){var a=this.dna.substring(4*geneLength,5*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,.77)},this.getRotationSpeed=function(){var a=this.dna.substring(5*geneLength,6*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,.4)},this.getColorOne=function(){var a,b,c,d=this.dna.substring(6*geneLength,7*geneLength);a=parseInt(d,2),a=round(map(a,0,1023,0,255)),d=this.dna.substring(7*geneLength,8*geneLength),b=parseInt(d,2),b=round(map(b,0,1023,0,255)),d=this.dna.substring(8*geneLength,9*geneLength),c=parseInt(d,2),c=round(map(c,0,1023,0,255));var e=color(a,b,c,this.opacity);return e},this.getColorTwo=function(){var a,b,c,d=this.dna.substring(9*geneLength,10*geneLength);a=parseInt(d,2),a=round(map(a,0,1023,0,255)),d=this.dna.substring(10*geneLength,11*geneLength),b=parseInt(d,2),b=round(map(b,0,1023,0,255)),d=this.dna.substring(11*geneLength,12*geneLength),c=parseInt(d,2),c=round(map(c,0,1023,0,255));var e=color(a,b,c,this.opacity);return e},this.getColorThree=function(){var a,b,c,d=this.dna.substring(12*geneLength,13*geneLength);a=parseInt(d,2),a=round(map(a,0,1023,0,255)),d=this.dna.substring(13*geneLength,14*geneLength),b=parseInt(d,2),b=round(map(b,0,1023,0,255)),d=this.dna.substring(14*geneLength,15*geneLength),c=parseInt(d,2),c=round(map(c,0,1023,0,255));var e=color(a,b,c,this.opacity);return e},this.getBranch1=function(){var a=this.dna.substring(15*geneLength,16*geneLength),b=parseInt(a,2);return b=round(map(b,0,1023,0,9))},this.getBranch2=function(){var a=this.dna.substring(16*geneLength,17*geneLength),b=parseInt(a,2);return b=round(map(b,0,1023,0,9))},this.getBranch3=function(){var a=this.dna.substring(17*geneLength,18*geneLength),b=parseInt(a,2);return b=round(map(b,0,1023,0,9))},this.getBranch4=function(){var a=this.dna.substring(18*geneLength,19*geneLength),b=parseInt(a,2);return b=round(map(b,0,1023,0,9))},this.getSize1=function(){var a=this.dna.substring(19*geneLength,20*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,20)},this.getSize2=function(){var a=this.dna.substring(20*geneLength,21*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,20)},this.getEndForm=function(){var a=this.dna.substring(21*geneLength,22*geneLength),b=parseInt(a,2);return b=round(map(b,0,1023,0,3))},this.getRotator=function(){var a=this.dna.substring(22*geneLength,23*geneLength),b=parseInt(a,2);return b=map(b,0,1023,0,TWO_PI)}}function Population(){this.MAX,this.mutationRate,this.population=[],this.dnaLength,this.spacer,this.constructor=function(a,b,c){this.mutationRate=a,this.MAX=b,this.dnaLength=c;for(var d=0;d<this.MAX;d++)this.population[d]=new Agent,this.population[d].construct(this.dnaLength);this.spacer=breederSize/sqrt(this.MAX)},this.reset=function(){for(var a=0;a<this.population.length;a++)this.population[a]=new Agent,this.population[a].construct(this.dnaLength)},this.generate=function(a,b){for(var e,f,c=a,d=b,g=[],h=0;h<this.population.length;h++){random(1)>.5?(e=this.population[c],f=this.population[d]):(e=this.population[d],f=this.population[c]);var i=e.mate(f),j=new Agent;j.constructDNAexists(i,230),j.mutate(this.mutationRate),g[h]=j}this.population=g},this.display=function(){push(),translate(width/2-breederSize/2,height/2-breederSize/2),translate(this.spacer/2,this.spacer/2);for(var a=0,b=0,c=0;c<this.population.length;c++)this.population[c].display(round(a*this.spacer),b),a++,a>sqrt(this.MAX)-1&&(a=0,b+=this.spacer);pop()}}function setup(){cnvs=createCanvas(windowWidth,windowHeight),mode=width>height,breederSize=mode?height-.15*height:width-.15*width,scaler=breederSize/808,infoModal=createDiv('<h1>BREEDER</h1><p>Breeder is a website designed to let people playfully explore the principle of <a href="https://en.wikipedia.org/wiki/Evolutionary_algorithm">artificial evolution</a>. The software is based on the concept of "the Biomorph" as proposed by the British evolutionary biologist Richard Dawkins in his book <a href="https://en.wikipedia.org/wiki/The_Blind_Watchmaker">The Blind Watchmaker</a>. Variables such as the colors, patterns, and movements of abstract visual elements are encoded into an artificial DNA. The visitor can crossbreed the genetic codes of these elements by selecting two of them to produce a new generation. The new generation inherits different genetic traits from both selected parents. Each childâ€™s genetic code is also slightly mutated in order for new genetic traits to arise over the course of multiple generations. This leads to an endless stream of rhythmically pulsating shapes that highlight the poetic beauty of the evolutionary process.</p><p>Breeder was created by <a href="http://www.ericparren.net">Eric Parren</a> using <a href="http://p5js.org/">P5.js</a></p>'),infoModal.addClass("info-modal"),infoModal.position(0,0),infoModal.size(width,height),infoModal.hide(),btnInfo=createButton("INFO"),btnFullscreen=createButton(""),btnReset=createButton("RESEED"),btnModalClose=createButton(""),btnInfo.size(100,30),btnFullscreen.size(30,30),btnReset.size(100,30),btnModalClose.size(50,50);var a=height/2+breederSize/2+10;btnInfo.position(width/2-115,a),btnFullscreen.position(width/2-15,a),btnReset.position(width/2+15,a),btnModalClose.position(width-60,0),btnInfo.mouseReleased(showInfo),btnReset.mouseReleased(resetGenepool),btnFullscreen.mouseReleased(toggleFullscreen),btnModalClose.mouseReleased(hideInfo),btnInfo.style("border-radius","15px 0px 0px 15px"),btnFullscreen.html('<i class="fa fa-expand"></i>'),btnReset.style("border-radius","0px 15px 15px 0px"),btnModalClose.html('<i class="fa fa-close fa-2x"></i>'),btnModalClose.addClass("close-button"),btnModalClose.hide(),side=breederSize/sqrtMaxNum;var b=23*geneLength;pops=new Population,pops.constructor(.02,maxNum,b)}function draw(){blendMode(BLEND),background(0),rectMode(CENTER),noFill(),strokeWeight(2),stroke(255,35);for(var a=width/2-breederSize/2;a<width/2-breederSize/2+breederSize+1;a+=breederSize/sqrtMaxNum)line(a,height/2-breederSize/2,a,height/2+breederSize/2);for(var a=height/2-breederSize/2;a<height/2-breederSize/2+breederSize+1;a+=breederSize/sqrtMaxNum)line(width/2-breederSize/2,a,width/2+breederSize/2,a);blendMode(ADD),pops.display(),blendMode(REPLACE),blendMode(BLEND),mFilled&&mHighlight(),dFilled&&dHighlight(),info||(selection(),newGeneration&&(setMil&&(mil=millis(),setMil=!1),abs(mil-millis())>300&&(pops.generate(mom,dad),newGeneration=!1,mFilled=!1,dFilled=!1,setMil=!0)))}function selection(){click&&(mFilled?(dad=selectParent(),dad<maxNum&&(dFilled=!0,newGeneration=!0),click=!1):(mom=selectParent(),mom<maxNum&&(mFilled=!0),click=!1))}function mouseReleased(){info||(locX=mouseX,locY=mouseY,click=!0)}function touchEnded(){return info||(locX=mouseX,locY=mouseY,click=!0),!1}function selectParent(){var a;return locX>width/2-breederSize/2&&locX<width/2-breederSize/2+side?locY>height/2-breederSize/2&&locY<height/2-breederSize/2+side?a=0:locY>height/2-breederSize/2+side&&locY<height/2-breederSize/2+2*side?a=1*sqrtMaxNum:locY>height/2-breederSize/2+2*side&&locY<height/2-breederSize/2+3*side&&(a=2*sqrtMaxNum):locX>width/2-breederSize/2+side&&locX<width/2-breederSize/2+2*side?locY>height/2-breederSize/2&&locY<height/2-breederSize/2+side?a=1:locY>height/2-breederSize/2+side&&locY<height/2-breederSize/2+2*side?a=1+1*sqrtMaxNum:locY>height/2-breederSize/2+2*side&&locY<height/2-breederSize/2+3*side&&(a=1+2*sqrtMaxNum):locX>width/2-breederSize/2+2*side&&locX<width/2-breederSize/2+3*side&&(locY>height/2-breederSize/2&&locY<height/2-breederSize/2+side?a=2:locY>height/2-breederSize/2+side&&locY<height/2-breederSize/2+2*side?a=2+1*sqrtMaxNum:locY>height/2-breederSize/2+2*side&&locY<height/2-breederSize/2+3*side&&(a=2+2*sqrtMaxNum)),a}function resetGenepool(){pops.reset(),mFilled=!1,dFilled=!1}function mHighlight(){strokeWeight(2),stroke(255,100),noFill(),rectMode(CORNER),push(),translate(width/2-breederSize/2,height/2-breederSize/2),translate(mom%sqrtMaxNum*side,floor(mom/sqrtMaxNum)*side),rect(0,0,side,side),pop()}function dHighlight(){strokeWeight(3),stroke(255,100),noFill(),rectMode(CORNER),push(),translate(width/2-breederSize/2,height/2-breederSize/2),translate(dad%sqrtMaxNum*side,floor(dad/sqrtMaxNum)*side),rect(0,0,side,side),pop()}function windowResized(){resizeCanvas(windowWidth,windowHeight),mode=width>height,breederSize=mode?height-.15*height:width-.15*width,scaler=breederSize/808,side=breederSize/sqrtMaxNum,pops.spacer=breederSize/sqrt(pops.MAX);var a=height/2+breederSize/2+10;btnInfo.position(width/2-115,a),btnFullscreen.position(width/2-15,a),btnReset.position(width/2+15,a),btnModalClose.position(width-60,0),infoModal.size(width,height)}function toggleFullscreen(){fs=!fs,fs?btnFullscreen.html('<i class="fa fa-compress"></i>'):btnFullscreen.html('<i class="fa fa-expand"></i>'),fullscreen(fs)}function showInfo(){infoModal.show(),btnInfo.hide(),btnFullscreen.hide(),btnReset.hide(),btnModalClose.show(),info=!0}function hideInfo(){infoModal.hide(),btnInfo.show(),btnFullscreen.show(),btnReset.show(),btnModalClose.hide(),info=!1}p5.disableFriendlyErrors=!0;var cnvs,fs=!1,info=!1,mode=!1,breederSize,scaler,btnInfo,btnReset,btnFullscreen,btnModalClose,infoModal,sqrtMaxNum=3,maxNum=sqrtMaxNum*sqrtMaxNum,side,offset,geneLength=10,pops,mom,dad,newGeneration,mFilled,dFilled,locX,locY,click,mil=0,setMil=!0;